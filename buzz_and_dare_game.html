<!DOCTYPE html>
<html lang="de" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buzz & Dare - Frutiger Aero Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
    <link rel="stylesheet" href="frutiger_aero.css">
    <style>
        /* Spezifische Anpassungen, die nicht im Global-CSS sind */
        .player-chip {
            display: inline-flex;
            align-items: center;
            background: linear-gradient(180deg, rgba(255,255,255,0.9) 0%, rgba(200,230,255,0.8) 100%);
            border: 1px solid #fff;
            padding: 5px 12px;
            border-radius: 15px;
            margin: 4px 4px 0 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-size: 0.9rem;
            color: #0052cc;
        }

        .player-remove {
            background: transparent;
            border: none;
            color: #ff4444;
            font-weight: bold;
            margin-left: 8px;
            cursor: pointer;
        }

        /* Inputs an das Aero-Design anpassen */
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #aaccff;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            outline: none;
            margin-bottom: 5px;
            color: #003366;
            font-family: 'Segoe UI', sans-serif;
            font-weight: 600;
        }

        .history-entry {
            padding: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.5);
            font-size: 0.9rem;
            color: #003366;
        }

        .highlight-text {
            color: #CC0000; /* Rot f√ºr den Spieler im Kartentext */
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255,255,255,0.8);
        }
        
        /* Status-Boxen nutzen das Aero-Highlight */
        #currentPlayer {
            color: #007bff;
        }
        #lastAction {
             color: #CC0000;
        }

        label {
            color: #003366;
            font-weight: 600;
            display: block;
            margin-bottom: 4px;
        }

        input[type="radio"] {
            accent-color: #0052cc;
            transform: scale(1.2);
        }
    </style>
</head>

<body class="antialiased overflow-x-hidden bg-animate">

    <div id="bubble-container"></div>
    <div id="cloud-container"></div>
    <div id="music-container"></div>
    <div id="icon-container"></div>

    <nav class="fixed top-0 w-full z-50 px-6 py-4">
        <div class="max-w-7xl container">
            <div class="glass rounded-full px-8 py-4 flex justify-between items-center transition-all duration-300">
                <div class="flex items-center gap-3">
                    <div class="orb w-10 h-10 flex items-center justify-center text-2xl" style="background-color: #f0f8ff;">
                        üçª
                    </div>
                    <span class="font-bold text-xl text-glossy">Buzz & Dare Game</span>
                </div>
                <div class="flex gap-6 text-sm font-semibold">
                    <a href="index.html" class="nav-link">Back to Homepage</a>
                </div>
            </div>
        </div>
    </nav>

    <div id="f-container" class="container mx-auto px-6 py-24 space-y-8 relative z-10 pt-40">
        
        <div class="f-content mb-8 text-center">
            <h1 class="gradient-text text-5xl font-bold mb-2">Get Buzzed!</h1>
            <p style="color: #004488;">Drinking & Truth or Dare Game</p>
        </div>

        <div class="grid md-grid-cols-2 gap-8">
            
            <aside class="aero-glass p-6 rounded-3xl card-hover">
                <h2 class="text-xl font-bold text-glossy mb-4">Players</h2>
                
                <div class="mb-4">
                    <input id="nameInput" type="text" placeholder="Enter name & press Enter" />
                    <div id="playersList" class="flex flex-wrap gap-2 mt-2 min-h-[40px]">
                        </div>
                    
                    <div class="flex gap-2 mt-4">
                        <button id="pickPlayerBtn" class="glossy-button p-2 text-white w-full font-bold">Pick Random</button>
                        <button id="clearPlayers" class="glossy-button p-2 text-white w-full font-bold" style="filter: hue-rotate(180deg);">Clear All</button>
                    </div>
                </div>

                <hr class="border-white opacity-50 my-4">
                
                <h3 class="font-bold text-glossy mb-2">Sip Settings</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-sm">Min Sips</label>
                        <input id="minSip" type="number" value="1" min="0" />
                    </div>
                    <div>
                        <label class="text-sm">Max Sips</label>
                        <input id="maxSip" type="number" value="3" min="0" />
                    </div>
                </div>
            </aside>

            <main class="flex flex-col gap-8">
                
                <div class="project-card p-8 text-center flex flex-col items-center justify-center min-h-[350px]">
                    <div class="shine-overlay"></div>
                    
                    <div class="orb w-14 h-14 mb-6 flex items-center justify-center">
                        <span style="font-size: 24px; font-weight:bold; color:#0052cc;">!</span>
                    </div>

                    <div id="mainCard" class="text-3xl font-bold text-glossy mb-8 leading-relaxed">
                        Loading cards...
                    </div>

                    <div class="w-full">
                        <button id="nextRoundBtn" class="glossy-button py-4 text-white text-2xl font-bold w-full hover-scale-110 transition-transform" disabled>
                            Start Next Round
                        </button>
                    </div>

                    <div class="mt-8 w-full flex justify-between text-base font-semibold" style="color: #004488;">
                        <div class="aero-glass px-4 py-2 rounded-xl">
                            Current Player: <span id="currentPlayer" class="highlight-text">‚Äî</span>
                        </div>
                        <div class="aero-glass px-4 py-2 rounded-xl">
                            Card Type: <span id="lastAction" class="highlight-text">‚Äî</span>
                        </div>
                    </div>
                </div>

                <div class="aero-glass p-4 rounded-xl flex-grow">
                    <h3 class="font-bold text-glossy mb-2 border-b border-white pb-1">History</h3>
                    <div id="history" class="overflow-y-auto max-h-[180px] space-y-2 pr-2">
                        </div>
                </div>

            </main>
        </div>
    </div>

    <script>
        // --- Hintergrund-Elemente (√úbernommen aus index.html) ---
        // Create floating bubbles
        const bubbleContainer = document.getElementById('bubble-container');
        const bubbleCount = 12;

        for (let i = 0; i < bubbleCount; i++) {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';

            const size = Math.random() * 80 + 40;
            bubble.style.width = size + 'px';
            bubble.style.height = size + 'px';
            bubble.style.left = Math.random() * 100 + '%';
            bubble.style.animationDuration = (Math.random() * 10 + 15) + 's';
            bubble.style.animationDelay = Math.random() * 5 + 's';

            bubbleContainer.appendChild(bubble);
        }

        // Create clouds
        const cloudContainer = document.getElementById('cloud-container');
        const cloudCount = 16;

        for (let i = 0; i < cloudCount; i++) {
            const cloud = document.createElement('div');
            cloud.className = 'cloud';

            const width = Math.random() * 200 + 150;
            const height = width * 0.6;
            cloud.style.width = width + 'px';
            cloud.style.height = height + 'px';
            cloud.style.top = Math.random() * 40 + '%';
            cloud.style.left = Math.random() * 100 + '%';
            cloud.style.animationDuration = (Math.random() * 40 + 60) + 's';
            cloud.style.animationDelay = Math.random() * 20 + 's';

            cloudContainer.appendChild(cloud);
        }

        // Create music notes
        const musicContainer = document.getElementById('music-container');
        const musicNotes = ['‚ô™', '‚ô´', '‚ô¨', '‚ô©'];
        const musicCount = 6;

        for (let i = 0; i < musicCount; i++) {
            const note = document.createElement('div');
            note.className = 'music-note';
            note.textContent = musicNotes[Math.floor(Math.random() * musicNotes.length)];

            note.style.left = Math.random() * 90 + 5 + '%';
            note.style.animationDuration = (Math.random() * 8 + 12) + 's';
            note.style.animationDelay = Math.random() * 10 + 's';

            musicContainer.appendChild(note);
        }

        // Create floating icons
        const iconContainer = document.getElementById('icon-container');
        const icons = [
            { emoji: 'üçª', size: '3rem' },
            { emoji: 'üé≤', size: '2.5rem' },
            { emoji: 'üíß', size: '3rem' },
            { emoji: 'ü•Ç', size: '2.5rem' },
            { emoji: 'üéâ', size: '3rem' },
            { emoji: 'ü•≥', size: '2rem' }
        ];

        icons.forEach((icon, index) => {
            const iconDiv = document.createElement('div');
            iconDiv.className = 'floating-icon';
            iconDiv.textContent = icon.emoji;
            iconDiv.style.fontSize = icon.size;

            const positions = [
                { top: '15%', left: '5%' },
                { top: '25%', right: '8%' },
                { top: '45%', left: '3%' },
                { top: '60%', right: '5%' },
                { top: '75%', left: '7%' },
                { top: '80%', right: '10%' }
            ];

            if (positions[index]) {
                Object.assign(iconDiv.style, positions[index]);
            }

            iconDiv.style.animationDuration = (Math.random() * 2 + 3) + 's';
            iconDiv.style.animationDelay = Math.random() * 2 + 's';

            iconContainer.appendChild(iconDiv);
        });

        // --- Spiel Logik ---
        let truthDareCards = [];
        const nextRoundBtn = document.getElementById('nextRoundBtn');
        const nameInput = document.getElementById('nameInput');
        const playersList = document.getElementById('playersList');
        const clearPlayersBtn = document.getElementById('clearPlayers');
        const currentPlayerSpan = document.getElementById('currentPlayer');
        const pickPlayerBtn = document.getElementById('pickPlayerBtn'); // Beibehalten f√ºr separate Spielerwahl
    
        // Lade die cards.json Datei
        fetch('cards.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Netzwerk-Antwort war nicht ok');
                }
                return response.json();
            })
            .then(data => {
                truthDareCards = data.cards;
                console.log("Karten erfolgreich geladen:", truthDareCards.length);
                
                const mainCard = document.getElementById("mainCard");
                mainCard.innerHTML = 'Press <span class="highlight-text">"Start Next Round"</span> to begin!';
                nextRoundBtn.disabled = false;
            })
            .catch(error => {
                console.error('Fehler beim Laden der Karten:', error);
                document.getElementById("mainCard").innerHTML = 
                    '<span style="color:red; font-size:0.8em; text-shadow:none;">Error loading cards.json.</span>';
            });

        // --- Spieler Management ---
        let players = [];
        // ... (Spieler hinzuf√ºgen/entfernen Logik bleibt gleich) ...
        nameInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const name = this.value.trim();
                if (name && !players.includes(name)) {
                    players.push(name);
                    updatePlayersList();
                    this.value = '';
                }
            }
        });

        function updatePlayersList() {
            playersList.innerHTML = '';
            players.forEach((player, index) => {
                const playerEl = document.createElement('div');
                playerEl.className = 'player-chip';
                playerEl.innerHTML = `
                ${player}
                <button class="player-remove" data-index="${index}">√ó</button>
                `;
                playersList.appendChild(playerEl);
            });

            document.querySelectorAll('.player-remove').forEach(button => {
                button.addEventListener('click', function () {
                    const index = parseInt(this.getAttribute('data-index'));
                    players.splice(index, 1);
                    updatePlayersList();
                });
            });
        }
        clearPlayersBtn.addEventListener('click', function () {
            players = [];
            updatePlayersList();
            currentPlayerSpan.textContent = '‚Äî';
        });

        // Helper f√ºr History
        function addToHistory(htmlContent) {
            const history = document.getElementById('history');
            const entry = document.createElement('div');
            entry.className = 'history-entry';
            entry.innerHTML = htmlContent;
            history.prepend(entry);
            // Limit history size
            while (history.children.length > 8) {
                history.removeChild(history.lastChild);
            }
        }
    
        // --- NEUE Kombinierte Logik ---
        function nextRound() {
            if (players.length === 0) {
                alert("Please add players before starting a round!");
                return;
            }
            if (truthDareCards.length === 0) {
                document.getElementById("mainCard").innerText = "No cards available!";
                return;
            }

            // 1. Pick Random Player
            const randomIndex = Math.floor(Math.random() * players.length);
            const selectedPlayer = players[randomIndex];
            currentPlayerSpan.textContent = selectedPlayer;

            // 2. Draw Card
            const cardIndex = Math.floor(Math.random() * truthDareCards.length);
            const card = truthDareCards[cardIndex];

            // 3. Calculate Sips
            const min = parseInt(document.getElementById("minSip").value) || 1;
            const max = parseInt(document.getElementById("maxSip").value) || 3;
            const randomSips = Math.floor(Math.random() * (max - min + 1)) + min;
            const cardText = card.text.replace(/\{n\}/g, randomSips);

            // 4. Update UI and History
            const typeText = card.type.toUpperCase();
            
            // Highlight the selected player and the card text in the main card
            const fullText = `<span class="highlight-text">${selectedPlayer}</span>, your task is: ${cardText}`;
            document.getElementById("mainCard").innerHTML = fullText;
            
            document.getElementById("lastAction").innerText = typeText;

            // History entry includes player and action type
            addToHistory(`<strong>${selectedPlayer} (${typeText}):</strong> ${cardText}`);
        }

        // Event Listener f√ºr den neuen Button
        nextRoundBtn.addEventListener("click", nextRound);

        // Behalte Pick Player f√ºr manuelle Auswahl (Sidebar Button)
        pickPlayerBtn.addEventListener('click', function() {
            if (players.length === 0) {
                currentPlayerSpan.textContent = 'No players';
                return;
            }
            const randomIndex = Math.floor(Math.random() * players.length);
            const selectedPlayer = players[randomIndex];
            currentPlayerSpan.textContent = selectedPlayer;
            addToHistory(`Selected player manually: <span class="highlight-text">${selectedPlayer}</span>`);
        });

    </script>
</body>
</html>